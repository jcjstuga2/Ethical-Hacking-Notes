- 1 - Scan with Nmap and dirbuster, find port 80 open and a path "/secret" that is a file saying that we should not waste time going trhough directories. We are left with port 53 dns to try. DNS: Domain Name System, it makes outgoing connections using port 53 for host name and IP address lookups.
- 2 - we can use dnsrecon to scan this port. "dnsrecon -r 127.0.0.0/24 -n 192.168.0.171 -d anything". -r is for the range, 127 is our local host. -d is domain but we can type anything we want, it is requiered.
- 3 - We found PTR blackpearl.tcm 127.0.0.1. We have to add this dns to our hosts file in /etc/hosts "nano /etc/hosts". Then we will be able to access http://blackpearl.tcm/.   
![[Pasted image 20230519113446.png]]
- 4 - We will use ffuf/dirbuster with the http://blackpearl.tcm/ and we find a /navifate. We find a login landing page for navigate cms. We can search online for "navigate cms exploit" and we find a unauthenticated remode code execution. https://www.exploit-db.com/exploits/45561
- We can use this module on metasploit, set the vhost to blackpearl.tcm and rhosts to the ip. and we get a shell by typing "shell".
- 5 - We have a weird shell so we can upgrade it by using a tty shell. Type on google "tty shell" https://wiki.zacheller.dev/pentest/privilege-escalation/spawning-a-tty-shell. Change it to bash insted of sh. "python -c 'import pty; pty.spawn("/bin/bash")'""
- 6 - Previlage escalation: "sudo -l" -> nothing found and no history. We can use linpeas. Move to /tmp and host the linpeas file on my machine using python and use wget from the tty shell. Use "chmod +x linpeas.sh", "./linpeas.sh". 
- 7 - On the  "Interesting Files" we find the SIUD. There are files created from root that have rwsr-xr-x. Normally there is no "s", insted there is a "x" from execute. The "s" means we can run this and we have the ability to run this as the owner, as root in this case. There is another are including SGID, including files with rwxr-sr-x, Meaning we can run this file as the group, not the owner. 
- 8 - We can find  the files with the suid allowed by typing "find / -type f -perm -4000 2> /dev/null ". Now that we know all the files/paths with SUID on we can use the GTFOBins - https://gtfobins.github.io/. We click on SIUD and the go trough the list and check if we have any match. We find that GTFO has a php link for SUID and we have a file php7.3, good place to try. https://gtfobins.github.io/gtfobins/php/#suid. 
![[Pasted image 20230519121600.png]]
- 9 - We just need to type "/usr/bin/php7.3 -r "pcntl_exec('/bin/sh', ['-p']);"" and we get the root access